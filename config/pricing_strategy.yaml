# ========================================
# 価格戦略設定ファイル
# ========================================
#
# このファイルは商品の出品価格を決定する戦略と係数を管理します。
# プロジェクトルート: C:\Users\hiroo\Documents\GitHub\ecauto\
#
# 設定変更後は、価格同期スクリプトを再実行することで新しい設定が適用されます。
# 実行環境タイムゾーン: JST

# ========================================
# デフォルト戦略
# ========================================
default_strategy: "simple_markup"

# ========================================
# 戦略別設定
# ========================================
strategies:
  # --------------------------------------------------
  # シンプルマークアップ（現行ロジック）
  # --------------------------------------------------
  # Amazon価格に固定のマークアップ率を適用
  simple_markup:
    markup_ratio: 1.3          # マークアップ率（30%利益）
    min_price_diff: 100        # 価格更新の最小差額（円）
                               # 価格差がこの値未満の場合、更新をスキップ
    round_to: 10               # 価格の丸め単位（円）
                               # 例: 1984円 → 1990円に調整

  # --------------------------------------------------
  # 価格帯別マークアップ
  # --------------------------------------------------
  # Amazon価格の価格帯に応じて異なるマークアップ率を適用
  # 低価格商品は高めのマージン、高価格商品は低めのマージンを設定
  tiered_markup:
    tiers:
      # 1000円以下の商品
      - max_price: 1000
        markup_ratio: 1.4      # 40%利益

      # 1001円〜5000円の商品
      - max_price: 5000
        markup_ratio: 1.3      # 30%利益

      # 5001円〜10000円の商品
      - max_price: 10000
        markup_ratio: 1.25     # 25%利益

      # 10001円以上の商品
      - max_price: null        # null = 上限なし
        markup_ratio: 1.2      # 20%利益

    min_price_diff: 100
    round_to: 10

  # --------------------------------------------------
  # カテゴリ別マークアップ（将来実装）
  # --------------------------------------------------
  # 商品カテゴリに応じて異なるマークアップ率を適用
  # ※現在は未実装。将来的にカテゴリ情報をDBに追加後に有効化
  category_based:
    default_markup_ratio: 1.3  # デフォルトマークアップ率

    # カテゴリ別のオーバーライド
    category_overrides:
      electronics: 1.25        # 家電は25%
      books: 1.4               # 本は40%
      toys: 1.35               # おもちゃは35%
      home: 1.3                # ホーム用品は30%
      fashion: 1.35            # ファッションは35%

    min_price_diff: 100
    round_to: 10

  # --------------------------------------------------
  # eBay専用カスタム戦略
  # --------------------------------------------------
  # eBay輸出ビジネスの実際のコスト構造に基づいた価格計算
  # 計算式: 売価 = (原価 + 送料 + 梱包資材代) / (1 - 手数料率 - 関税率 - 利益率)
  ebay_custom:
    # 固定コスト
    shipping_cost: 4000        # 送料（円）※将来的にサイズ別バリエーション対応予定
    packaging_cost: 500        # 梱包資材代（円）

    # 売価に対する割合
    ebay_fee_rate: 0.17        # eBay手数料率（17%）売価から引かれる
    customs_duty_rate: 0.15    # 関税率（15%）売価に対して課税される
    profit_margin: 0.20        # 目標利益率（20%）

    # その他設定
    round_to: 10               # 価格の丸め単位（円）
    min_price_diff: 100        # 価格更新の最小差額（円）

    # 将来的な拡張: サイズ別送料バリエーション
    # 現在は未使用。将来的にサイズ情報がDBに追加されたら有効化
    # shipping_cost_variants:
    #   small: 2000            # 小型商品
    #   medium: 4000           # 中型商品（デフォルト）
    #   large: 6000            # 大型商品
    #   extra_large: 8000      # 特大商品

# ========================================
# 通貨換算設定
# ========================================
# プラットフォーム別に異なる通貨で価格を設定する場合の為替レート設定
currency_conversion:
  # デフォルト通貨
  default_source: "JPY"

  # 為替レート（yfinance APIから自動取得）
  # ※ 以下は参考値。実際はCurrencyManagerが動的に取得します
  rates:
    JPY_to_USD: 150.0  # 1 USD = 150 JPY（参考値・フォールバック用）

  # キャッシュ設定
  cache_duration_hours: 24  # 為替レートのキャッシュ有効期間（時間）

  # 為替レートAPI設定（将来的な拡張用）
  # api_provider: "yfinance"  # yfinance（デフォルト）
  # fallback_rate: 150.0      # API取得失敗時のフォールバックレート

# ========================================
# プラットフォーム別オーバーライド
# ========================================
# プラットフォームごとに異なる価格戦略・通貨を適用可能
platform_overrides:
  base:
    strategy: "simple_markup"  # BASEはシンプルマークアップを使用
    target_currency: "JPY"     # 日本円で価格設定

  ebay:
    strategy: "ebay_custom"    # eBay専用戦略（手数料を考慮）
    # strategy: "simple_markup"  # シンプルな場合はこちら
    # strategy: "tiered_markup"  # 価格帯別の場合はこちら
    target_currency: "USD"     # USDで価格設定
    # 通貨換算は自動的に実施される

  # 将来的な拡張例
  # mercari:
  #   strategy: "tiered_markup"
  #   target_currency: "JPY"
  #   min_price_diff: 50       # メルカリは50円以上の差で更新
  #
  # yahoo_auction:
  #   strategy: "category_based"
  #   target_currency: "JPY"
  #   min_price_diff: 100

# ========================================
# 安全装置
# ========================================
# 異常な価格設定を防ぐための上限・下限値
safety:
  min_selling_price: 500       # 最低出品価格（円）
                               # これ以下の価格では出品しない

  max_selling_price: 100000    # 最高出品価格（円）
                               # これ以上の価格では出品しない

  max_markup_ratio: 2.0        # 最大マークアップ率（異常検知）
                               # Amazon価格の2倍を超える場合は警告

  min_markup_ratio: 1.05       # 最小マークアップ率（異常検知）
                               # Amazon価格の1.05倍未満の場合は警告
                               # （5%未満の利益率は異常とみなす）

# ========================================
# ログ設定
# ========================================
logging:
  log_price_changes: true      # 価格変更をログに記録
  log_strategy_used: true      # 使用した戦略をログに記録
  alert_on_extreme_price: true # 極端な価格の場合に警告を出力
